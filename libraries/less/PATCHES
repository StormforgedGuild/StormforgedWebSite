Patches applied:

#327
#343
#336